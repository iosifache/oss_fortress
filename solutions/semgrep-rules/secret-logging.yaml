rules:
  - id: secret-logging
    patterns:
      - pattern-either:
          - pattern: $LOGGING_LIB.$METHOD(..., $MESSAGE, ...)
      - metavariable-pattern:
          metavariable: $LOGGING_LIB
          patterns:
            - pattern-either:
                - pattern: logging
                - pattern: logger
      - metavariable-pattern:
          metavariable: $MESSAGE
          patterns:
            - pattern-either:
                - pattern: <... password ...>
                - pattern: <... token ...>
            - pattern-not: |
                "..."
    message: Logging of sensitive information
    languages:
      - python
    severity: WARNING
    metadata:
      category: security
      subcategory:
        - vuln
      cwe:
        - "CWE 215: Insertion of Sensitive Information Into Debugging Code"
      confidence: MEDIUM
      likelihood: LOW
      impact: MEDIUM
      owasp:
        - A3:2017 Sensitive Data Exposure
