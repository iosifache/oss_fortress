rules:
  - id: hash-length-extension-attack
    patterns:
      - pattern: |
          strcpy($BUFFER, ...);
          ...
          sha256_update(..., $BUFFER, ...);
    message: A SHA256 hash length extension attack is possible.
    languages:
      - c
    severity: WARNING
    metadata:
      category: security
      subcategory:
        - vuln
      cwe:
        - "CWE 1240: Use of a Cryptographic Primitive with a Risky
          Implementation"
      confidence: HIGH
      likelihood: MEDIUM
      impact: HIGH
      owasp:
        - A2:2021 Cryptographic Failures
